@model IEnumerable<SinetLeaveManagement.Models.Notification>

@{
    ViewData["Title"] = "Notifications";
}

<h4>Notifications (@Model.Count())</h4>

<ul class="list-group">
    @foreach (var n in Model)
    {
        <li class="list-group-item d-flex justify-content-between align-items-center">
            <span>@n.Message</span>
            <span>
                <small class="text-muted">@n.CreatedAt.ToLocalTime()</small>
                <button class="btn btn-sm btn-outline-success ms-2 mark-read-btn" data-id="@n.Id">
                    ✔
                </button>
            </span>
        </li>
    }
</ul>

@section Scripts {
    <script>
        $(document).on("click", ".mark-read-btn", function () {
            var btn = $(this);
            var id = btn.data("id");

            $.post('/Notification/MarkAsRead', { id: id })
             .done(function () {
                 btn.closest("li").fadeOut();
             });
        });
    </script>
}
